package docker

import (
	"os/exec"

	"github.com/NucleoFusion/cruise/internal/enums"
)

type Vulnerability struct {
	VulnID     string
	Pkg        string // PkgName + InstalledVersion
	Severity   enums.Severity
	Title      string
	Published  string
	PrimaryURL string
}

func ScannerAvailable(scanner string) bool {
	_, err := exec.Command("bash", "-c", scanner+" --version").CombinedOutput() // TODO: Config file based checker
	return err == nil
}

// func TrivyScanImage(name string) {
// 	report := struct {
// 		Results []struct {
// 			Vulns []struct {
// 				VulnerabilityID  string
// 				PkgName          string
// 				InstalledVersion string
// 				Title            string
// 				Severity         string
// 				Description      string
// 				PrimaryURL       string
// 				PublishedDate    string
// 			} `json:"Vulnerabilities"`
// 		} `json:"Results"`
// 	}{}
//
// 	cmd := exec.Command("bash", "-e", "trivy") // TODO: Use custom shell (as provided by config)
// }
